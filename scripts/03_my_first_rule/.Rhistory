load("~/Stuff/qtl_paper/upload_suppl_information/rqtl/scripts/simulate_crosses.Rhistory.RData")
cross_1_qtl_intervals
cross_2_qtl_intervals
cross_4_qtl_intervals
load("~/Stuff/qtl_paper/upload_suppl_information/rqtl/scripts/simulate_crosses.R")
load("~/Stuff/qtl_paper/upload_suppl_information/rqtl/scripts/simulate_crosses.Rhistory.RData")
cross_2_qtl_intervals
qtl_intervals<-1:n_its
qtl_additional_intervals_bp<-1:n_its
#qtl3
for(it_i in 1:n_its){
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
library(qtl)
#qtl3
for(it_i in 1:n_its){
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
#qtl3
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
n_its<-100
qtl_intervals<-1:n_its
qtl_intervals_bp<-1:n_its
#qtl3
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
hist(qtl_intervals, nclass=30)
hist(qtl_intervals_bp, nclass=30)
cross_2_qtl
hist(qtl_intervals_bp, nclass=30)
hist(qtl_intervals, nclass=30)
hist(qtl_intervals_bp, nclass=30)
hist(qtl_intervals, nclass=30)
hist(qtl_intervals_bp, nclass=30)
qtl_intervals<-1:n_its
qtl_intervals_bp<-1:n_its
#qtl5
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[5,1],cross_2_qtl[5,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[5,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
qtl_alpha<-sqrt(2*cross_2_qtl[3,3]/(1-cross_2_qtl[3,3]))
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
hist(qtl_intervals_bp, nclass=30)
hist(qtl_intervals, nclass=30)
qtl_intervals
n_its<-100
qtl_intervals<-1:n_its
qtl_intervals_bp<-1:n_its
#qtl3
qtl_alpha<-sqrt(2*cross_2_qtl[3,3]/(1-cross_2_qtl[3,3]))
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = F)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
qtl_intervals
qtl_intervals_bp
hist(qtl_intervals_bp, nclass=30)
var_exp=0.25
qtl_alpha<-sqrt(2*var_exp/(1-var_exp))
for(it_i in 1:n_its){
print(it_i)
sim_cross<-sim.cross(cross_S1_lm_list, n.ind=368, type="f2", c(cross_2_qtl[3,1],cross_2_qtl[3,2],qtl_alpha,0))
sim_cross<-calc.genoprob(sim_cross)
sim_hk<-scanone(sim_cross, method="hk")
sim_bi<-bayesint(results=sim_hk, chr=cross_2_qtl[3,1],expandtomarkers = T)
qtl_length_cm_end<-sim_bi$pos[3]
qtl_length_cm_start<-sim_bi$pos[1]
qtl_intervals[it_i]<-qtl_length_cm_end-qtl_length_cm_start
qtl_length_bp_end<-as.numeric(unlist(strsplit(row.names(sim_bi)[3],split = "_"))[2])
qtl_length_bp_start<-as.numeric(unlist(strsplit(row.names(sim_bi)[1],split = "_"))[2])
qtl_intervals_bp[it_i]<-qtl_length_bp_end-qtl_length_bp_start
}
hist(qtl_intervals_bp, nclass=30)
hist(qtl_intervals, nclass=30)
cross_2_qtl
install.packages("BiocManager")
BiocManager::install(c("Biostrings", "rtracklayer"))
install.packages("phangorn")
library(phangorn)
install.packages("StamPP")
install.packages("StAMPP")
install.packages("vcfR")
3162759+3426460+4254577+3614718+3449084+3609645+3276773+3231142
14618584+5518088+532826+16854
5518088/(14618584+5518088+532826+16854)
532826/(14618584+5518088+532826+16854)
14618584/(14618584+5518088+532826+16854)
16854/(14618584+5518088+532826+16854)
4.61-5.39
5.39-4.61
(5.39-4.61)
(5.39-4.61)*0.1481
4.61+((5.39-4.61)*0.1481)
5.39-((5.39-4.61)*0.1481)
(600000)/(14618584+5518088+532826+16854)
library(vcfR)
setwd("~/Stuff/snakemake-course/scripts/03_my_first_rule/")
vcf_input<-read.vcfR("03_slim_output.vcf")
vcf_input
input_genlight<-vcfR2genlight(vcf_input)
input_genlight
@ind.names
input_genlight@ind.names
setwd("~/Stuff/snakemake-course/scripts/03_my_first_rule/")
vcf_input<-read.vcfR("03_slim_output.vcf")
vcf_genlight<-vcfR2genlight(vcf_input)
vcf_genlight
vcf_genlight@gen
vcf_genlight@loc.all
gt <- extract.gt(vcf_input, element = "GT")
gt
as.matrix(vcf_genlight)
gts <- t(as.matrix(vcf_genlight))
gts
rowSums(gts)
allele_counts<-rowSums(gts)
hist(alt_counts)
alt_counts<-rowSums(gts)
hist(alt_counts)
hist(alt_counts, nclass=50)
hist(alt_counts, nclass=100)
hist(alt_counts, nclass=ncol(gts)*2)
hist(alt_counts, nclass=ncol(gts)*2, xlab="number of alt alleles", title="SFS")
hist(alt_counts, nclass=ncol(gts)*2, xlab="number of alt alleles", main="SFS")
